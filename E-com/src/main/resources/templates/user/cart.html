<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{base::layout(~{::section})}">
<head>
  <meta charset="ISO-8859-1">
  <title>Your Cart</title>
</head>
<body>
<section>
  <div class="container-fluid mt-5 p-5">

    <div class="card card-sh">
      <div class="card-header text-center">
        <p class="fs-4">Cart Page</p>
        <th:block th:if="${session.succMsg}">
          <p class="text-success fw-bold">[[${session.succMsg}]]</p>
        </th:block>
        <th:block th:if="${session.errorMsg}">
          <p class="text-danger fw-bold">[[${session.errorMsg}]]</p>
          <th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
        </th:block>
      </div>
      <div class="card-body">
        <table class="table">
          <thead>
          <tr>
            <th scope="col">Sl No</th>
            <th scope="col">Image</th>
            <th scope="col">Product Name</th>
            <th scope="col">Price</th>
            <th scope="col" class="text-center">Quantity</th>
            <th scope="col">Total Price</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="cart,c:${carts}">
            <th scope="row">[[${c.count}]]</th>
            <td><img th:src="@{'/img/product_img/'+${cart.product.image}}"
                     width="70px" height="70px"></td>
            <td>[[${cart.product.title}]]</td>
            <td>[[${cart.product.discountPrice}]]</td>
            <td class="text-center"><a
                    th:href="@{'/user/cartQuantityUpdate?sy=de&cid='+${cart.id}}">
              <i class="fa-solid fa-minus"></i>
            </a> [ [[${cart.quantity}]] ] <a
                    th:href="@{'/user/cartQuantityUpdate?sy=in&cid='+${cart.id}}">
              <i class="fa-solid fa-plus"></i>
            </a></td>
            <td>[[${cart.totalPrice}]]</td>
          </tr>
          <tr>
            <td colspan="4"></td>
            <td class="fw-bold">Total Price</td>
            <td class="fw-bold">&#8377; [[${totalOrderPrice}]]</td>
          </tr>
          </tbody>
        </table>
        <div class="text-center">
          <a href="/user/orders" class="btn btn-warning"> Proceed Payment</a>
        </div>

        <div class="mt-5 pt-4 border-top" th:if="${recommendedProducts != null and not recommendedProducts.isEmpty()}">
          <h3 class="text-center mb-4">You Might Also Like</h3>
          <div class="row">

            <div class="col-md-3" th:each="product : ${recommendedProducts}">
              <div class="card h-100">
                <img th:src="@{'/img/product_img/' + ${product.image}}" class="card-img-top"
                     alt="Product Image" style="height: 200px; object-fit: cover;">
                <div class="card-body text-center">
                  <h5 class="card-title" style="font-size: 1rem;" th:text="${product.title}">Product Title</h5>
                  <p class="card-text fw-bold" th:text="'&#8377; ' + ${product.discountPrice}">&#8377; 99.99</p>

                  <form th:action="@{/user/addCart}" method="get" class="d-inline">
                    <input type="hidden" name="pid" th:value="${product.id}" />
                    <input type="hidden" name="uid" th:value="${user.id}" />
                    <button type="submit" class="btn btn-sm btn-primary">Add to Cart</button>
                  </form>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
</body>
</html>